import{r as o}from"./react.56e6c9f0.js";import{_ as he,c as Fe}from"./@babel.22c28777.js";import{F as pe,a as be,m as U,f as _,g as ge,b as xe}from"./focus-lock.efd1d6df.js";import{c as W,a as Ie}from"./use-sidecar.f9c7c831.js";import{a as Pe,F as we,j as F}from"./@chakra-ui.f2948015.js";import{u as Ce}from"./use-callback-ref.dfbc4bbb.js";import{w as Le}from"./react-clientside-effect.213ae13e.js";var T={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},$=W({},function(r){var e=r.target,t=r.currentTarget;return{target:e,currentTarget:t}}),N=W(),ye=W(),Ee=Ie({async:!0}),Oe=[],B=o.exports.forwardRef(function(e,t){var n,u=o.exports.useState(),s=u[0],d=u[1],l=o.exports.useRef(),x=o.exports.useRef(!1),c=o.exports.useRef(null),i=e.children,a=e.disabled,C=e.noFocusGuards,v=e.persistentFocus,I=e.crossFrame,f=e.autoFocus;e.allowTextSelection;var m=e.group,E=e.className,X=e.whiteList,Y=e.hasPositiveIndices,R=e.shards,Z=R===void 0?Oe:R,D=e.as,ee=D===void 0?"div":D,H=e.lockProps,te=H===void 0?{}:H,re=e.sideCar,L=e.returnFocus,ne=e.focusOptions,O=e.onActivation,S=e.onDeactivation,oe=o.exports.useState({}),ae=oe[0],ue=o.exports.useCallback(function(){c.current=c.current||document&&document.activeElement,l.current&&O&&O(l.current),x.current=!0},[O]),se=o.exports.useCallback(function(){x.current=!1,S&&S(l.current)},[S]);o.exports.useEffect(function(){a||(c.current=null)},[]);var ie=o.exports.useCallback(function(h){var P=c.current;if(P&&P.focus){var k=typeof L=="function"?L(P):L;if(k){var A=typeof k=="object"?k:void 0;c.current=null,h?Promise.resolve().then(function(){return P.focus(A)}):P.focus(A)}}},[L]),ce=o.exports.useCallback(function(h){x.current&&$.useMedium(h)},[]),de=N.useMedium,fe=o.exports.useCallback(function(h){l.current!==h&&(l.current=h,d(h))},[]),le=he((n={},n[pe]=a&&"disabled",n[be]=m,n),te),M=C!==!0,ve=M&&C!=="tail",me=Ce([t,fe]);return Pe(we,{children:[M&&[F("div",{"data-focus-guard":!0,tabIndex:a?-1:0,style:T},"guard-first"),Y?F("div",{"data-focus-guard":!0,tabIndex:a?-1:1,style:T},"guard-nearest"):null],!a&&F(re,{id:ae,sideCar:Ee,observed:s,disabled:a,persistentFocus:v,crossFrame:I,autoFocus:f,whiteList:X,shards:Z,onActivation:ue,onDeactivation:se,returnFocus:ie,focusOptions:ne}),F(ee,{ref:me,...le,className:E,onBlur:de,onFocus:ce,children:i}),ve&&F("div",{"data-focus-guard":!0,tabIndex:a?-1:0,style:T})]})});B.propTypes={};B.defaultProps={children:void 0,disabled:!1,returnFocus:!1,focusOptions:void 0,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,hasPositiveIndices:void 0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};const q=B;function z(r){var e=window,t=e.setImmediate;typeof t<"u"?t(r):setTimeout(r,1)}var Se=function(){return document&&document.activeElement===document.body},ke=function(){return Se()||xe()},b=null,p=null,g=null,w=!1,Te=function(){return!0},We=function(e){return(b.whiteList||Te)(e)},Be=function(e,t){g={observerNode:e,portaledElement:t}},Ge=function(e){return g&&g.portaledElement===e};function j(r,e,t,n){var u=null,s=r;do{var d=n[s];if(d.guard)d.node.dataset.focusAutoGuard&&(u=d);else if(d.lockItem){if(s!==r)return;u=null}else break}while((s+=t)!==e);u&&(u.node.tabIndex=0)}var Re=function(e){return e&&"current"in e?e.current:e},De=function(e){return e?Boolean(w):w==="meanwhile"},He=function r(e,t,n){return t&&(t.host===e&&(!t.activeElement||n.contains(t.activeElement))||t.parentNode&&r(e,t.parentNode,n))},Me=function(e,t){return t.some(function(n){return He(e,n,n)})},y=function(){var e=!1;if(b){var t=b,n=t.observed,u=t.persistentFocus,s=t.autoFocus,d=t.shards,l=t.crossFrame,x=t.focusOptions,c=n||g&&g.portaledElement,i=document&&document.activeElement;if(c){var a=[c].concat(d.map(Re).filter(Boolean));if((!i||We(i))&&(u||De(l)||!ke()||!p&&s)&&(c&&!(_(a)||i&&Me(i,a)||Ge(i))&&(document&&!p&&i&&!s?(i.blur&&i.blur(),document.body.focus()):(e=U(a,p,{focusOptions:x}),g={})),w=!1,p=document&&document.activeElement),document){var C=document&&document.activeElement,v=ge(a),I=v.map(function(f){var m=f.node;return m}).indexOf(C);I>-1&&(v.filter(function(f){var m=f.guard,E=f.node;return m&&E.dataset.focusAutoGuard}).forEach(function(f){var m=f.node;return m.removeAttribute("tabIndex")}),j(I,v.length,1,v),j(I,-1,-1,v))}}}return e},J=function(e){y()&&e&&(e.stopPropagation(),e.preventDefault())},G=function(){return z(y)},Ae=function(e){var t=e.target,n=e.currentTarget;n.contains(t)||Be(n,t)},je=function(){return null},K=function(){w="just",setTimeout(function(){w="meanwhile"},0)},Ue=function(){document.addEventListener("focusin",J),document.addEventListener("focusout",G),window.addEventListener("blur",K)},_e=function(){document.removeEventListener("focusin",J),document.removeEventListener("focusout",G),window.removeEventListener("blur",K)};function $e(r){return r.filter(function(e){var t=e.disabled;return!t})}function Ne(r){var e=r.slice(-1)[0];e&&!b&&Ue();var t=b,n=t&&e&&e.id===t.id;b=e,t&&!n&&(t.onDeactivation(),r.filter(function(u){var s=u.id;return s===t.id}).length||t.returnFocus(!e)),e?(p=null,(!n||t.observed!==e.observed)&&e.onActivation(),y(),z(y)):(_e(),p=null)}$.assignSyncMedium(Ae);N.assignMedium(G);ye.assignMedium(function(r){return r({moveFocusInside:U,focusInside:_})});const qe=Le($e,Ne)(je);var Q=o.exports.forwardRef(function(e,t){return F(q,{sideCar:qe,ref:t,...e})}),V=q.propTypes||{};V.sideCar;Fe(V,["sideCar"]);Q.propTypes={};const Ze=Q;export{Ze as F};
